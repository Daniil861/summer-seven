(()=>{"use strict";let e=!1;setTimeout((()=>{if(e){let e=new Event("windowScroll");window.addEventListener("scroll",(function(t){document.dispatchEvent(e)}))}}),0),sessionStorage.getItem("preloader")&&(document.querySelector(".preloader")&&document.querySelector(".preloader").classList.add("_hide"),document.querySelector(".wrapper").classList.add("_visible")),sessionStorage.getItem("money")||sessionStorage.setItem("money",1e3),document.querySelector(".score")&&document.querySelectorAll(".score").forEach((e=>{e.textContent=sessionStorage.getItem("money")})),sessionStorage.getItem("resource")||sessionStorage.setItem("resource",50),document.querySelector(".resource")&&document.querySelectorAll(".resource").forEach((e=>{e.textContent=sessionStorage.getItem("resource")}));const t=document.querySelector(".preloader"),o=document.querySelector(".wrapper"),n=document.documentElement.clientWidth;document.documentElement.clientHeight;function s(e,t,o){let n=+sessionStorage.getItem(o);sessionStorage.setItem(o,n-e),setTimeout((()=>{document.querySelectorAll(t).forEach((e=>e.classList.add("_delete-money"))),document.querySelectorAll(t).forEach((e=>e.textContent=sessionStorage.getItem(o)))}),500),setTimeout((()=>{document.querySelectorAll(t).forEach((e=>e.classList.remove("_delete-money")))}),1900)}function l(e){document.querySelectorAll(e).forEach((e=>e.classList.add("_no-money"))),setTimeout((()=>{document.querySelectorAll(e).forEach((e=>e.classList.remove("_no-money")))}),1400)}function r(e,t){return Math.floor(Math.random()*(t-e)+e)}function c(e,t){sessionStorage.setItem(t,JSON.stringify(e))}function i(e,t){let o=a(e);o.push(t),c(o,e)}function a(e){let t=JSON.parse(sessionStorage.getItem(e));return t.sort((function(e,t){return e-t})),t}let u=document.querySelectorAll(".icon-anim img");document.querySelector(".icon-anim img")&&setInterval((()=>{!function(){let e=r(0,3),t=["jump","scale","rotate"],o=r(0,u.length);u.forEach((e=>{e.classList.contains("_anim-icon-jump")?e.classList.remove("_anim-icon-jump"):e.classList.contains("_anim-icon-scale")?e.classList.remove("_anim-icon-scale"):e.classList.contains("_anim-icon-rotate")&&e.classList.remove("_anim-icon-rotate")})),setTimeout((()=>{u[o].classList.add(`_anim-icon-${t[e]}`)}),100)}()}),2e4);const d=1200,m=3e3,_=65,g=100;function y(){if(!sessionStorage.getItem("airplanes")){c(["0"],"airplanes")}}function f(){document.querySelector('[data-price="1"]').textContent=d,document.querySelector('[data-price="2"]').textContent=m,document.querySelector('[data-price="3"]').textContent=_,document.querySelector('[data-price="4"]').textContent=g,document.querySelector('[data-airplane="1"]').setAttribute("data-count",d),document.querySelector('[data-airplane="2"]').setAttribute("data-count",m),document.querySelector('[data-airplane="3"]').setAttribute("data-count",_),document.querySelector('[data-airplane="4"]').setAttribute("data-count",g)}function S(){let e=a("airplanes"),t=document.querySelectorAll(".item-store");e.forEach((e=>{t.forEach((t=>{t.dataset.airplane==e&&setTimeout((()=>{t.classList.add("_bought")}),0)}))}))}function p(){if(sessionStorage.getItem("current-airplane")){let e=+sessionStorage.getItem("current-airplane");document.querySelectorAll(".item-store").forEach((t=>{t.dataset.airplane==e&&t.classList.add("_selected")}))}}document.querySelector(".main")&&document.querySelector(".preloader").classList.contains("_hide")&&(document.querySelector(".main").classList.add("_active"),y(),f(),S(),p());const v=document.documentElement.clientWidth,q=document.documentElement.clientHeight,L={secondAirplane:"",level:1,win_money:0,win_diamonds:0,win_resource:0,win:!1,timerIdBonus:!1,timerCl:!1,createGunPilotTimer:!1},h={count:10,currentCount:0,healthEnemy_1:1,healthEnemy_2:2,healthEnemy_3:4,healthEnemy_4:6},I={airWidth:100,currentPosition:0,speed:5,gunSpeed:30,x:0};function A(){""!==L.secondAirplane?I.currentPosition=30*v/100:I.currentPosition=47*v/100,document.querySelector(".field__player").style.left=`${I.currentPosition}px`}function b(){""!==L.secondAirplane?(document.querySelector(".field__pilot").style.backgroundImage=`url("img/airplans/air-${L.secondAirplane+1}.svg")`,document.querySelector(".field__pilot").style.left="60%"):(document.querySelector(".field__pilot").style.display="none",document.querySelector(".field__pilot").classList.add("_target"))}function w(){1==L.level?h.count=10:2==L.level?h.count=15:3==L.level?h.count=20:4==L.level&&(h.count=25),h.currentCount=h.count}function C(){s(+sessionStorage.getItem("current-bet"),".score","money"),function(){let e=1500;setTimeout((()=>{let t=15;L.timerIdBonus=setInterval((()=>{!function(){let e=0,t=r(1,5),o=r(1,5);1==L.level?e=r(10,60):2==L.level?e=r(10,40):3==L.level?e=r(7,30):4==L.level&&(e=r(5,20));let n=r(0,+v-150),s=document.createElement("div");s.classList.add("field__enemy"),s.setAttribute("data-value",t),s.setAttribute("data-target",0);let l=document.createElement("img");l.setAttribute("src",`img/enemys/bugz-${t}.svg`),l.setAttribute("alt","Image"),l.setAttribute("data-whole",""),l.classList.add(`_anim-${o}`),s.append(l),s.style.left=`${n}px`,document.querySelector(".field__enemies").append(s);let c=!1,i=0;c=setInterval((()=>{i+=.5,s.style.transform=`translateY(${i}px)`,i+70>q-50&&(s.classList.add("_hold"),setTimeout((()=>{clearInterval(c),s.remove()}),700))}),e)}(),h.currentCount--,t=h.currentCount,h.currentCount<=0&&clearInterval(L.timerIdBonus)}),e);let o=setInterval((()=>{document.querySelectorAll(".field__enemy").length<=0&&t<=0&&(L.win=!0,clearInterval(o),L.level<4&&L.win&&L.level++,E())}),100)}),200)}(),function(){let e=1200,t=+sessionStorage.getItem("current-airplane");if(t){setInterval((()=>{1==t?e=1200:2==t?e=1e3:3==t?e=700:4==t&&(e=500)}),100);L.createGunPilotTimer=setInterval((()=>{!document.querySelector(".field__pilot").classList.contains("_target")&&document.querySelector(".field__pilot").classList.contains("_move")&&x(".field__pilot")}),e)}}(),document.querySelector(".field__pilot").classList.contains("_move")||document.querySelector(".field__pilot").classList.add("_move")}function E(){document.querySelector(".field__pilot").classList.remove("_move"),L.win?(L.win_money=L.win_money*+sessionStorage.getItem("current-bet"),document.querySelector(".win__sub-text").textContent="Win",document.querySelector(".score-finaly").textContent=L.win_money,document.querySelector(".resource-finaly").textContent=L.win_diamonds,document.querySelectorAll(".win__star").forEach((e=>{e.classList.contains("_transparent")&&e.classList.remove("_transparent")}))):(document.querySelector(".win__sub-text").textContent="Loose",document.querySelector(".score-finaly").textContent=L.win_money,document.querySelector(".resource-finaly").textContent=L.win_diamonds,document.querySelectorAll(".win__star").forEach((e=>e.classList.add("_transparent")))),setTimeout((()=>{document.querySelector(".win").classList.add("_active"),function(e,t,o,n){let s=Math.floor(+sessionStorage.getItem("money")+e);setTimeout((()=>{sessionStorage.setItem("money",s),document.querySelectorAll(t).forEach((e=>e.textContent=sessionStorage.getItem("money"))),document.querySelectorAll(t).forEach((e=>e.classList.add("_anim-add-money")))}),o),setTimeout((()=>{document.querySelectorAll(t).forEach((e=>e.classList.remove("_anim-add-money")))}),n)}(L.win_money,".score",500,1500),function(e,t,o,n){let s=Math.floor(+sessionStorage.getItem("resource")+e);setTimeout((()=>{sessionStorage.setItem("resource",s),document.querySelectorAll(t).forEach((e=>e.textContent=sessionStorage.getItem("resource"))),document.querySelectorAll(t).forEach((e=>e.classList.add("_anim-add-money")))}),o),setTimeout((()=>{document.querySelectorAll(t).forEach((e=>e.classList.remove("_anim-add-money")))}),n)}(L.win_diamonds,".resource",500,1500)}),500)}function x(e){let t=document.querySelector(e),o=t.getBoundingClientRect().left,n=t.getBoundingClientRect().top,s=t.clientWidth-30,l=document.createElement("div");l.classList.add("field__box-gun");let r=document.createElement("span");r.classList.add("field__gun-one"),r.style.left=`${o}px`,r.style.top=`${n}px`;let c=document.createElement("span");c.classList.add("field__gun-two"),c.style.left=`${o+s}px`,c.style.top=`${n}px`,l.append(r,c),document.querySelector(".game__body").append(l);let i=1,a=setInterval((()=>{i+=I.gunSpeed,r.style.transform=`translateY(${-i}px)`,c.style.transform=`translateY(${-i}px)`,i>q&&(l.remove(),r.remove(),c.remove(),clearInterval(a))}),60);!function(e,t,o){let n=h.healthEnemy_1,s=h.healthEnemy_2,l=h.healthEnemy_3,r=h.healthEnemy_4,c=setInterval((()=>{document.querySelectorAll(".field__enemy").forEach((i=>{let a=i.clientWidth,u=i.clientHeight;if(e.getBoundingClientRect().left>i.getBoundingClientRect().left&&e.getBoundingClientRect().left<i.getBoundingClientRect().left+a&&e.getBoundingClientRect().top<i.getBoundingClientRect().top+u&&!i.classList.contains("_caput")||t.getBoundingClientRect().left>i.getBoundingClientRect().left&&e.getBoundingClientRect().left+o<i.getBoundingClientRect().left+a&&t.getBoundingClientRect().top<i.getBoundingClientRect().top+u&&!i.classList.contains("_caput")){let o=i.dataset.target;1==i.dataset.value&&i.dataset.target>n||2==i.dataset.value&&i.dataset.target>s||3==i.dataset.value&&i.dataset.target>l||4==i.dataset.value&&i.dataset.target>r?(i.classList.add("_caput"),B(i),setTimeout((()=>{i.remove()}),2500)):i.classList.add("_target"),o++,i.dataset.target=o,e.remove(),t.remove(),clearInterval(c),setTimeout((()=>{i.classList.remove("_target")}),500)}}))}),10)}(r,c,s)}function B(e){1==e.dataset.value?L.win_money+=1:2==e.dataset.value?L.win_money+=2:3==e.dataset.value?(L.win_money+=3,L.win_diamonds+=10):4==e.dataset.value&&(L.win_money+=4,L.win_diamonds+=20)}function R(){document.querySelector(".field__player")&&(document.querySelector(".field__player").style.left=`${I.currentPosition}px`)}function T(){let e=document.querySelector(".field__player"),t=document.querySelector(".field__pilot"),o=e.clientWidth,n=t.clientWidth,s=setInterval((()=>{e.classList.contains("_target")&&t.classList.contains("_target")&&(L.win=!1,clearInterval(s),clearInterval(L.timerIdBonus),document.querySelectorAll(".field__enemy").forEach((e=>{e.classList.add("_hold"),setTimeout((()=>{e.remove()}),500)})),E()),document.querySelectorAll(".field__enemy").forEach((s=>{let l=s.clientWidth,r=s.clientHeight;e.getBoundingClientRect().left+o>s.getBoundingClientRect().left&&e.getBoundingClientRect().left<s.getBoundingClientRect().left+l&&e.getBoundingClientRect().top<s.getBoundingClientRect().top+r&&!s.classList.contains("_caput")&&e.classList.add("_target"),t.getBoundingClientRect().left+n>s.getBoundingClientRect().left&&t.getBoundingClientRect().left<s.getBoundingClientRect().left+l&&t.getBoundingClientRect().top<s.getBoundingClientRect().top+r&&!s.classList.contains("_caput")&&t.classList.add("_target")}))}),100)}function P(){clearInterval(L.createGunPilotTimer),L.win_diamonds=0,L.win_money=0,w(),document.querySelector(".field__player").classList.contains("_target")&&document.querySelector(".field__player").classList.remove("_target"),document.querySelector(".field__pilot").classList.contains("_target")&&document.querySelector(".field__pilot").classList.remove("_target"),A(),b(),C(),T()}document.querySelector(".game")&&document.querySelector(".preloader").classList.contains("_hide")&&(sessionStorage.getItem("current-airplane")&&(L.secondAirplane=+sessionStorage.getItem("current-airplane")),A(),b(),w(),setTimeout((()=>{C(),T()}),500)),document.addEventListener("click",(e=>{let n=e.target;if(n.closest(".preloader__button")&&setTimeout((()=>{sessionStorage.setItem("preloader",!0),t.classList.add("_hide"),o.classList.add("_visible"),document.querySelector(".main")&&document.querySelector(".preloader").classList.contains("_hide")&&(document.querySelector(".main").classList.add("_active"),y(),f(),S(),p())}),300),n.closest(".footer__button ")&&document.querySelector(".main__body").classList.add("_bet"),n.closest(".footer__btn-card ")&&document.querySelector(".main__body").classList.add("_store"),n.closest(".bet-box__button-back")&&document.querySelector(".main__body").classList.remove("_bet"),n.closest(".store__btn-back")&&document.querySelector(".main__body").classList.remove("_store"),n.closest(".bet-box__button")){let e=+n.closest(".bet-box__button").dataset.bet;sessionStorage.setItem("current-bet",e),setTimeout((()=>{location.href="game.html"}),500)}n.closest(".item-store")&&!n.closest(".item-store").classList.contains("_bought")&&(!function(e){let t=e.dataset.count,o=e.dataset.airplane;o<3?+sessionStorage.getItem("money")>=t?(setTimeout((()=>{e.classList.add("_bought")}),0),s(t,".score","money"),i("airplanes",o)):l(".score"):o>=3&&(+sessionStorage.getItem("resource")>=t?(setTimeout((()=>{e.classList.add("_bought")}),0),s(t,".resource","resource"),i("airplanes",o)):l(".resource"))}(n.closest(".item-store")),S()),n.closest(".item-store")&&n.closest(".item-store").classList.contains("_bought")&&(document.querySelectorAll(".item-store").forEach((e=>{e.classList.contains("_selected")&&e.classList.remove("_selected")})),sessionStorage.setItem("current-airplane",n.closest(".item-store").dataset.airplane),setTimeout((()=>{n.closest(".item-store").classList.add("_selected")}),300)),n.closest(".field")&&x(".field__player"),n.closest(".win__button")&&(document.querySelector(".win").classList.remove("_active"),P())})),document.addEventListener("touchstart",(e=>{if(e.target.closest(".field__player")){let t=e.touches[0];I.x=t.clientX}})),document.addEventListener("touchmove",(e=>{if(e.target.closest(".field__player")){if(!I.x)return!1;let t=e.touches[0].clientX-I.x;const o=document.querySelector(".field__player"),s=window.getComputedStyle(o);let l=parseInt(s.left,10);t>0?I.currentPosition<n-130&&(I.currentPosition+=I.speed,R()):l>0&&(I.currentPosition-=I.speed,R())}})),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||document.addEventListener("mousemove",(e=>{I.currentPosition=e.clientX-50,R()})),window.FLS=!0,function(e){let t=new Image;t.onload=t.onerror=function(){e(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}((function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)})),window.addEventListener("load",(function(){document.querySelector("body")&&setTimeout((function(){document.querySelector("body").classList.add("_loaded")}),200)}))})();